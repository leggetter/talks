<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Writing JavaScript Apps to Scale - Phil @leggetter</title>

    <meta name="description" content="Writing JavaScript Apps to Scale - Phil @leggetter">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="../css/reveal.min.css">
    <link rel="stylesheet" href="../css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="../lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="../css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
    </script>

    <style>
      .slides section.present.trans
       {
        background: #1c1e20;
        background: -moz-radial-gradient(center, circle cover, #555a5f 0%, #1c1e20 100%);
        background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%, #555a5f), color-stop(100%, #1c1e20));
        background: -webkit-radial-gradient(center, circle cover, #555a5f 0%, #1c1e20 100%);
        background: -o-radial-gradient(center, circle cover, #555a5f 0%, #1c1e20 100%);
        background: -ms-radial-gradient(center, circle cover, #555a5f 0%, #1c1e20 100%);
        background: radial-gradient(center, circle cover, #555a5f 0%, #1c1e20 100%);
        background-color: #2b2b2b;

        opacity: 0.8 !important;
      }

      .slides img {
        border: 0 !important;
        box-shadow: none !important;
        border: none !important;
      }

      .slides section.present.trans > * {
        opacity: 1 !important;
      }

      .slides section.big-quote blockquote {
        font-size: 2em;
      }

      .slides section.about {
        min-height: 500px !important;
        text-align: left;
        display: inline-block;
      }

      .slides section.about img {
        position: absolute;
        right: 0;
        top: 0;
      }

      .slides section ul {
        margin-bottom: 30px;
      }

      .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
        text-transform: none;
      }

      html {
        background: #1c1e20;
      }

      html.fullbg body {
        background-position:center;
        background-size: 100%;
        background-repeat: no-repeat;
      }

      html.fullbg.opportunity body {
        background-image: url('http://foursquare.wpengine.netdna-cdn.com/wp-content/uploads/2010/12/ps_cs_highres1.jpg');
      }

      html.fullbg.google-analytics body {
        background-image: url('../img/google-analytics.jpg');
      }

      html.fullbg.caplin-trader body {
        background-image: url('../img/caplin-noir.png');
      }

      html.fullbg.bladerunnerjs body {
        background-image: url('../img/brjs-bottom-left-logo-on-black.jpg');
      }

      html.fullbg.workbenches body {
        background-position:top center;
        background-image: url('img/workbench_v2.png');
      }

      code, .code {
        text-transform: none !important;
      }

      .reveal pre code {
        max-height: none;
      }

      .slides pre {
        font-size: 0.70em;
      }

      @-webkit-keyframes pulse {
        from {
          /*opacity: 0.0;*/
          font-size: 200%;
        }
        to {
          /*opacity: 1.0;*/
          font-size: 400%;
        }
      }

      @-moz-keyframes pulse {
        from {
          /*opacity: 0.0;*/
          font-size: 200%;
        }
        to {
          /*opacity: 1.0;*/
          font-size: 400%;
        }
      }
    
      .pulse {
        -webkit-animation-name: pulse;
        -webkit-animation-duration: 3s;
        -webkit-animation-iteration-count: infinite;
        -webkit-animation-timing-function: ease-in-out;
        -webkit-animation-direction: alternate;

        -moz-animation-name: pulse;
        -moz-animation-duration: 3s;
        -moz-animation-iteration-count: infinite;
        -moz-animation-timing-function: ease-in-out;
        -moz-animation-direction: alternate;
      }

      .reveal .slides section .fragment.fade-out.visible {
        display: none; /* override default so no UI space it taken up */
      }

      aside.notes {
        white-space: pre;
      }
    </style>

    <!--[if lt IE 9]>
    <script src="../lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">

<!--Intro-->
<section>

<section data-markdown class="trans" data-state="">
<script type="text/template">
## Writing JavaScript Apps 

<h1 class="pulse">to Scale</h1>
</script>
</section>

<section data-markdown>

<script type="text/template">
Phil [@leggetter](https://twitter.com/leggetter)

[phil@leggetter.co.uk](mailto:phil@leggetter.co.uk)

[Caplin Systems](http://www.caplin.com)

<a href="http://bladerunnerjs.org">
  <img src="../img/bladerunner-js-white-trans-lrg.png" style="border: 0; box-shadow: none; background: none; width: 50%"; />
</a>

[@BladeRunnerJS](https://twitter.com/bladerunnerjs)
</script>
</section>

</section>
<!-- /Intro -->

<!-- Background -->

<section>

<section data-markdown>
<script type="text/template">
# "Scale"
</script>
</section>

<section data-markdown>
<script type="text/template">
## What is a large-scale JavaScript app?

> In my view, large-scale JavaScript apps are non-trivial applications requiring significant developer effort to maintain,
where most heavy lifting of data manipulation and display falls to the browser.

<small><a href="http://addyosmani.com/largescalejavascript/">Addy Osmani - Large-Scale JavaScript</a></small>

</script>
</section>

<section>

<h2 class="fragment shrink fade-out" data-fragment-index="1">
<pre><code data-trim>
var scalingJS =
  !serverInfrastructure;
</code></pre>
</h2>
<h2 class="fragment roll-in" data-fragment-index="1">
        <pre class="fragment shrink fade-out"><code data-trim>
var maintainableFrontEndApp = 1;
var scalingJS =
  !!maintainableFrontEndApp;
</code></pre>
</h2>
<h2 class="fragment roll-in"  data-fragment-index="2">
        <pre class="fragment shrink fade-out" data-fragment-index="3"><code data-trim>
var maintainableFrontEndApp = 1;
// Erm?!
var scalingJS =
  !!maintainableFrontEndApp;</code></pre>
</h2>
<div class="fragment roll-in" data-fragment-index="3">
<h2><pre><code data-trim>
function FrontEndApp() {
  this.maintainable = true;
};

var scalingJS = new FrontEndApp();
</code></pre>
</h2>
<small><a href="http://j.mp/double-not">Try it out: j.mp/double-not</a></small>
</div>

<aside class="notes">
* It means defining a structure and way of creating applications
* A way that is maintainable
* And creating apps that follow those principles
</aside>
</section>

<section data-markdown>
<script type="text/template">
# What factors affect scaling?
</script>
</section>

<section data-markdown>
<script type="text/template">
# 1. Complexity
</script>
</section>

<section data-markdown>
<script type="text/template">
![](img/gmail-compose-open.png)
</script>
</section>

<section data-markdown>
<script type="text/template">
![](img/caplin-fx-motif.png)
</script>
</section>

<section data-markdown>
<script type="text/template">
### Gmail & Caplin Trader

* Large Single Page Apps (SPAs)
* Complex functionality
* Complex interactions
  * Technology
  * User
</script>

<aside class="notes">
* Complexity:
  * More functionality = more code
  * More interaction between pieces of code
  * Increase in potential code paths
</aside>
</section>

<section data-markdown>
<script type="text/template">
# 2. Size (Large Codebase)

More functionality = More Code
</script>
</section>

<section data-markdown>
<script type="text/template">
# Caplin Trader

* SDK:
  * 1,004 JavaScript files
  * 130,594 LoC
  * ~100 lines per file (inc. comments + whitespace)
* Tests:
  * 641 files
  * 95,000 LoC
* Reference implementation:
  * 425 JavaScript files
  * ~50,000 LoC
  * 200 test files
  * 21,000 LoC
</script>

<aside class="notes">
* Managing all that can be difficult
* How do you structure things?
* How do you ensure you know where to find pieces of functionality
</aside>
</section>

<section data-markdown>
<script type="text/template">
# 3. Contributors

The Human Factor
</script>
</section>

<section data-markdown>
<script type="text/template">
# Who contributors to an app?

* Multiple devs
* Multiple teams
* Front-end devs
* Back-end devs
* Designers
* QA
* Infrastructure
</script>

<aside class="notes">
* How do you manage access
* How do you manage collaboration and communication?
* How do you stop clashes e.g. code conflicts?
</aside>
</section>

<section data-markdown>
<script type="text/template">
# Caplin Dev Teams Diag
</script>
</section>

<section data-markdown>
<script type="text/template">
# Customer Dev Teams Diag
</script>
</section>

<section data-markdown>
<script type="text/template">
## Scale apps to account for:

1. complexity
2. Size (codebase)
3. Contributors (human factors)
</script>
</section>

<section data-markdown>
<script type="text/template">
# What causes scaling problems?
</script>
</section>

<section data-markdown>
<script type="text/template">
# Scaling problems caused by

* Inconsitency
* Unnecessary Complexity
* Overlapping concerns (better term for this)

</script>
<aside class="notes">
<small>
* As code and practices become inconsistent it:
  * Different people attempting the same thing in different ways
  * Becomes difficult to work out where functionality is implemented
  * Potentially duplicate effort
* Creating functionality that does more than one thing
* Accessing functionality that is unrelated
  * CSS for one component impacting another
  * ex. Gmail input el string parsing being used in the email composer
</small>
</aside>
</section>

<section data-markdown>
<script type="text/template">
# Problems avoided through

* Consistency
* Simplicity
* Separation of Concerns (SoC)

<h2 class="fragment">Enabled through Principles, Practices & Tooling</h2>

</script>
<aside class="notes">
<small>
* We invert the problems:
  * Inconsistency => Consistency
  * Complexity => Simplicity
  * Separation of concerns
    * presentation layer, business logic layer, data access layer, persistence layer
    * HTML (content + a bit of structure), CSS (styling), JavaScript (behaviour)
    * Code - One bit of code should do a single thing (SRP)
* Tooling can take many forms e.g.
  * Frameworks
  * Toolkits
  * Dev tools e.g. Browser dev tools
  * Libraries
  * Workflow enablers
</small>
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Patterns & Practices

These are the patterns & practices we've considered when:

* Defining our development workflow
* Defining our application architecture
* Defining & building our development tools

## Tooling

* Building our tooling: [BladeRunnerJS](http://bladerunnerjs.org)

</script>
</section>

<section data-markdown>
<script type="text/template">
## Tooling enables, encourages (and enforces) good practices

* Consistent Coding Style
* Consistent Code Structure
* A Maintainable Application Architecture
  * Technology & Human Factors
* Code quality through testing
</script>

<aside class="notes">
</aside>
</section>

</section>
<!--/Background -->

<!--Coding Style-->
<section>

<section data-markdown>
<script type="text/template">
# Coding Style
</script>
</section>

<section data-markdown>
<script type="text/template">
## Coding Style Guide

> Programming style is a set of rules or guidelines used when writing the source code for a computer program. It is often claimed that following a particular programming style will help programmers to read and understand source code conforming to the style, and help to avoid introducing errors.

<small>aka <a href="http://en.wikipedia.org/wiki/Programming_style">Programming Style</a></small><br />
<small>note: <a href="http://en.wikipedia.org/wiki/Coding_conventions">&quot;Coding Conventions&quot;</a> can cover much more</small>

</script>

<aside class="notes">
* It's for consistency
  * declarations
  * statements
  * naming conventions
  * comments
</aside>
</section>

<section data-markdown>
<script type="text/template">
# Static Code Analysis

* Define a Coding Style
* Check with JSHint
</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Editor Integration
### Realtime feedback

![](img/sublime-jshint.png)
</script>
</section>

<section data-markdown>
<script type="text/template">
# Workflow Integration

* Feedback on:
  * File save
  * Local build / F5
</script>
</section>

<section data-markdown>
<script type="text/template">
# CI Build Integration

* Build fails if style guide rules are not met
</script>
</section>

<section data-markdown>
<script type="text/template">
## Tooling

* [JSHint](http://www.jshint.com/install/) support for:
  * VIM
  * Emacs
  * Sublime text
  * TextMate
  * Visual Studio
* [jshint-eclipse](http://github.eclipsesource.com/jshint-eclipse/)
* Grunt plugin: [grunt-contrib-jshint](https://github.com/gruntjs/grunt-contrib-jshint)
* [WebStorm jshint](http://www.jetbrains.com/webstorm/webhelp/jshint.html)

## Guides

* [Caplin's Coding Style Guide](http://caplin.github.io/StyleGuide/)
* [Airbnb's JavaScript Style Guide](https://github.com/airbnb/javascript)
</script>

<aside class="notes">
</aside>
</section>

</section>
<!--/Coding Style-->

<!--Code Structure-->
<section>

<section data-markdown>
<script type="text/template">
# Code Structure
</script>

<aside class="notes">
* Things like Object definitions
</aside>
</section>

<section data-markdown>
<script type="text/template">
## JavaScript === Flexible
</script>

<aside class="notes">
* JavaScript is a dynamic language
* It's highly flexable
* This is a great gift, as well as a curse
  * So many ways of achieving the same thing
* If you allow JavaScript to be used in all possible ways your codebase will become very difficult to follow
</aside>
</section>

<section data-markdown>
<script type="text/template">
# Use a Programming Paradigm

* All developers
* Across all teams
</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## We use Classical OOP

* Classes
* Inheritance
* Interfaces
* Everything is a Class or Interface
* Support for this using [Topiarist library](http://bladerunnerjs.github.io/topiarist/)
</script>

<aside class="notes">
* Consistency:
  * The vast majority of developers are familiar with OOP
  * Proven to scale in the Enterprise
    * This is nothing new to JavaScript, but it works
* Simplicity
  * Human-being understand it at a conceptual level
  * Promotes decoupling
  * Single Responsibility Principle
* JS is a prototype-based programming language so we use a library (Topiarist) to achieve this
* `class` is coming in ECMAScript 6
</aside>
</section>


<section data-markdown>
<script type="text/template">
### Classes

```
// Define a class
function ArnoldRimmer() {
  this.name = 'Arnold Judas Rimmer';
}

// Define functions
ArnoldRimmer.prototype.answerExamPaper = function() {
  var answer = '';
  for( var i = 0; i < 500; ++i ) {
    answer += 'I am a fish.';
  }
  return answer;
};

var rimmer = new ArnoldRimmer();
```
</script>
</section>

<section data-markdown>
<script type="text/template">
### Inheritance

```
// Define a specialisation (subclass)
function AceRimmer() {
  ArnoldRimmer.call( this );

  this.name = 'Ace';
}
topiarist.extend( AceRimmer, ArnoldRimmer );

// Override functions
AceRimmer.prototype.answerExamPaper = function() {
  return 'Something very clever and brave.';
};
```
</script>
</section>

<section data-markdown>
<script type="text/template">
### Interfaces

```
// Define an Interface
function SmegHead() {
}
SmegHead.prototype.lie = function() {
  throw new Error( 'lie must be implemented by Class' );
};

// Override functions
function ArnoldRimmer() {
  this.name = 'Arnold Judas Rimmer';
}
// Arnold Judas Rimmer is a Smeg Head
topiarist.implement( ArnoldRimmer, SmegHead )

ArnoldRimmer.prototype.lie = function() {
  return 'I aced my engineering exam';
};
```
</script>
</section>

<section data-markdown>
<script type="text/template">
## OO Benefits

* Widely understood
* Developed for complex systems
* Reusable, maintainable, single responsibity principle
* Modularity (LSP)
* Simple, Consistent, Promotes SoC
</script>

<aside class="notes">
* Anybody that understands OO will understand the code
* Developed to solve software quality in complex systems
* Modularity: Substitutability (Liskov substitution principle)
</aside>
</section>

<section data-markdown>
<script type="text/template">
# Use a consistent mechanism to define functionality
</script>
<aside class="notes">
* We use classical OOP
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Packages / Namespaces / Modules / Libraries
</script>

<aside class="notes">
* You want to organise your code in some way
* You don't want code definitions to accidentally overwrite other definitions (global namespace)
* You want to be able to share code in modules or libraries
</aside>
</section>

<section data-markdown class="code-smaller">
<script type="text/template">
## Code Example: How we used to do things
    
    some.namespace.AnInterface = function() {}

    some.namespace.AnInterface.prototype.implementMe = function() {
      throw new Error( 'implementMe not implemented' );
    };

    some.other.namespace.BaseClass = function() {
      this.baseProperty = 'base';
    };

    an.other.namespace.SubClass = function() {
      this.subProperty = 'sub';
    };
    topiary.extend( an.other.namespace.SubClass, some.other.namespace.BaseClass );
    topiary.implement( an.other.namespace.SubClass, some.namespace.AnInterface );

    an.other.namespace.MyObject.prototype.implementMe = function() {
    };

</script>

<aside class="notes">
* We used to have a tool that would generate the namespaces in JS before any of the files were loaded based on convention - folder structure
</aside>
</section>

<section data-markdown>
<script type="text/template">
### Code Example: How we now do things
    
    var AnInterface = require( 'some/namespace/AnInterface' );
    var BaseClass = require( 'some/other/namespace/BaseClass' );

    function SubClass() {
      this.subProperty = 'sub';
    }
    topiary.extend( SubClass, BaseClass );
    topiary.implement( SubClass, AnInterface );

    SubClass.prototype.implementMe = function() {
    };

    module.exports = SubClass;

</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Tooling

* [Topiary](https://github.com/BladeRunnerJS/topiary) library to help with OOP
* Scaffolding: CLI to help generate classes, interfaces etc.
  * [Yeoman](http://yeoman.io)
  * BRJS CommandPlugin<sup>†</sup>


* Node.JS modules supported via:
  * dev tool
  * module-loader JS library
* Code structure checked on F5
* JSDoc

<small>† May offer this</small>
</script>

<aside class="notes">
* Because our code is structured by convention our tooling can actually check the structure.
</aside>
</section>

</section>
<!--/Code Structure-->

<!--Architecture-->
<section>

<section data-markdown>
<script type="text/template">
# Application Architecture
</script>

<aside class="notes">
* Application structure
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Application Structure

* Functional components
* Application plumbing & foundations
* Assets
</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Architecture Goals

<small>a.k.a Buzz Terms</small>

* Separation of Concerns
  * Code, Application Architecture and Assets
* Loosely coupling
* High cohesion

## Divide & Conquer

</script>

<aside class="notes"><small>
* SoC
  * Code - already achieved through OOP
  * How: app architecture
  * How: assets?
* Loose coupling - the constituents of our architecture know as little about other components as possible
* High cohesion - our constituents of our app to be grouped to provide a single well-defined piece of functionality

* Divide & Conquer: Running theme of creating small pieces of decoupled functionality.
* Think of this as dividing your web app into simple pieces of functionality - throughout
* In order to conquer the challenges that you face when building such apps.

* Our code is close to being:
  * S - Single responsiblity principle
  * O - Open/closed principle
  * L - Liskov substitution principle
  * I - Interface segregation principle
  * D - Dependency inversion principle

<small><a href="(http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)">SOLID wikipedia defintion</a></small>
</small>
</aside>
</section>

<section data-markdown data-online-img="https://docs.google.com/drawings/d/1a2Opv-dEWL_RWsdj-bjaQg-3nz-EeVVJRO_vGTg1gVo/pub?w=1440&h=1080">
<script type="text/template">
### Application Overview

![](img/brjs-basic-architecture.png)
</script>

<aside class="notes">
* UI Components
  * MVVM
* Libraries
  * Reusable components
  * Useful shared functionality e.g. WHAT?
* Blades - application feature
* EventHub
* Services
* Aspects
</aside>
</section>

<section data-markdown>
<script type="text/template">
### Application Assets

![](img/asset-structure.png)
</script>
</section>

</section>
<!-- /Architecture -->

<!-- Components -->

<section>

<section data-markdown data-online-img="https://docs.google.com/drawings/d/1h7vb-SgklqIlDZe_C1WPoPBgjbMBHyPQ5u9lKI2ORB8/pub?w=1438&h=819">
<script type="text/template">
### Components

![](img/gmail-compose-open-components.png)

</script>

<aside class="notes">
* Even at that level we want SoC
* How do we achieve that?
</aside>
</section>

<section data-markdown>
<script type="text/template">
## MV*

* MVC, MVP, MVVM
* We use Presenter, built on KnockoutJS
</script>

<aside class="notes">
* Our components are MV* components
* We follow the MVVM architectual pattern within our apps.
* I'm not going to go into the details here.
* Will cover under "Code Quality"
</aside>
</section>

<section data-markdown>
<script type="text/template">
### MVVM

![](img/mvvm.png)

</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Components

* Reusable
* Contain all required assets:
  * JavaScript
  * HTML
  * CSS
  * i18n
  * Other resources
* Composite components
  * Components containing other components  

</script>

<aside class="notes">
* We have SoC
* High Cohesion
* No sign of loose compling yet
  * That's an app architecture level thing
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Tools, Libs & Other Component Solutions

* [Presenter](http://bladerunnerjs.org/docs/concepts/presenter/)
* [Web Components](http://www.w3.org/TR/components-intro/)
* [Polymer](http://www.polymer-project.org/)
* [Montage](http://montagejs.org/)
* [Flight](http://twitter.github.io/flight/)
* & the usual suspects: KnockoutJS, Backbone, Angular, Ember
  * But, these are more than just component libraries
</script>

<aside class="notes">
</aside>
</section>

</section>

<!-- /Components -->

<!-- Blades -->

<section>

<section data-markdown data-online-img="https://docs.google.com/drawings/d/1S78A4Gcm9GFrzzIXoJcJUwt6FcI792NKKroTvzBT-MM/pub?w=1438&h=819">
<script type="text/template">
## Blades

![](img/gmail-compose-open-blades.png)
</script>
</section>

<section data-markdown>
<script type="text/template">
## Blades

* Reference components in libraries
* Define app-specific components
* Provide app-specific functionality
* Contain all required assets:
  * JavaScript
  * HTML
  * CSS
  * i18n
  * Other resources

</script>

<aside class="notes">
Again we have:

* SoC
* High Cohesion
* No sign of loose compling yet
  * That's an app architecture level thing
</aside>
</section>

</section>
<!-- / Blades -->

<!-- Services -->
<section>

<section data-markdown>
<script type="text/template">
## Services

![](img/brjs-basic-architecture-services.png)

</script>
</section>

<section data-markdown>
<script type="text/template">
## Services

* Use services to access resources
* Perform common non-UI tasks
* e.g.
  * PersistenceService
  * RealtimeService
  * LoggingService
* Services registered and accessed via a `ServiceRegistry`
* IoC / Dependency Injection

</script>
</section>

<section data-markdown>
<script type="text/template">
## Services

* Uses Intefaces
* Access to resources

```
function HologramPersistenceService() {
}

HologramPersistenceService.prototype.backup = function( hologram ) {
  throw new Error( 'backup must be implemented by Class' );
};

HologramPersistenceService.prototype.restore = function( name ) {
  throw new Error( 'restore must be implemented by Class' );
};
```
</script>
</section>

<section data-markdown>
<script type="text/template">
## Using Services

Define Service

```
function MongoDBHologramBackup() {
}
topiarist.implements( MongoDBHologramBackup, HologramPersistenceService );

// implementation overrides
```

Register Service

```
var ServiceRegistry = require( 'br/ServiceRegistry' );

ServiceRegistry.registerService( 'hologram-persistence-service',
                                 new MongoDBHologramBackup() );

```
</script>
</section>

<section data-markdown>
<script type="text/template">
## Using Services (cont)

Access & Use Service

```
var ServiceRegistry = require( 'br/ServiceRegistry' );

var hologramBackupService =
  ServiceRegistry.getService( 'hologram-persistence-service' );

hologramBackupService.backup( rimmer );
rimmer.off();

var krissy = hologramBackupService.restore( 'Kristine Kochanski' );
krissy.on();
```
</script>
</section>

<section data-markdown>
<script type="text/template">
## Event Hub

* Communication between application components
</script>
</section>

</section>
<!-- / Services -->

<section data-markdown>
<script type="text/template">
## Tooling

* Libraries: glue
  * Event Hub library
  * Service Registery library
</script>

<aside class="notes">
</aside>
</section>

</section>
<!--/Architecture-->

<!--Asset Structure-->
<section>

<section data-markdown>
<script type="text/template">
# Asset Structure
</script>
</section>

<section data-markdown>
<script type="text/template">
## Group by Feature. Not type.

![](img/asset-structure.png)

* Isolation
  * Large teams
  * Multiple teams
* Functional [Cohesion][cohesion]

[cohesion]: http://en.wikipedia.org/wiki/Cohesion_(computer_science)
</script>

<aside class="class">
* Cohesion - desirable traits of Software Quality
  * Robustness
  * Reliablity
  * Reusability
  * Understandablity
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Blades & Libraries

* Blades/Components - application level functionality
* Libraries - cross application shared functionality
</script>

<aside class="class">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Tooling

* CL tools that understand structure
* Workbenches...
</script>
</section>

</section>

<section data-markdown data-state="fullbg workbenches">
<script type="text/template">
</script>

<aside class="class">
* Run components/blades in isolation
* Great for the development process
* For building integration tests, and writing a lot of the underlying code
* Stub and mock out Services
* Stub and mock Event Hub interactions
</aside>
</section>

</section>
<!--/Asset Structure-->

<!--Code Quality-->
<section>

<section data-markdown>
<script type="text/template">
# Code Quality
</script>

<aside class="notes">
* It's pretty obvious that for a JS app to scale - for it to be maintainable - it has to be well tested.
* How do we go about this.
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Simplicity & Consistency

* Coding Style
* Code Structure
  * OOP
  * Module loader
* Architecture
  * Event Hub
  * Services
  * Divide & Conquer
* Asset Structure
  * Group by feature
  * Develop & Test in isolation
</script>

<aside class="notes">
* All the things we're already doing result in it being very easy to test our code
* Keeping things simple and being consistent naturally reduces the likelihood of mistakes
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Developer Experience

* Know how to style and structure code
* Knows Architecture to follow and use
* Knows where to put new code and find existing code
* Supported by tooling
</script>

<aside class="notes">
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Testing
![](img/testing-triangle.png)
</script>
</section>

<section data-markdown>
<script type="text/template">
## Unit Testing
</script>

<aside class="notes">
* OOP
  * Code is structured in a way which help understanding and reduces bugs
  * Each class does one thing - test that small piece of functionality
  * Objects interact through interfaces - use mocks and stubs to check interactions
* Event Hub and Services means application components are loosely coupled and you can run them in isolation without real instances of dependences;
  * libraries
  * other modules
  * back-end services
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Integration Testing

* Event Hub
* Services
* MVVM
</script>

<aside class="notes">
* Event Hub and Services are here for just that.
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Acceptance Testing
</script>

<aside class="notes">
</aside>
</section>

</section>
<!--/Code Quality-->

<!--Conclusion-->
<section>

<section data-markdown>
<script type="text/template">
# Conclusion
</script>
</section>

<section data-markdown>
<script type="text/template">
* Complexity will increase
* Following Principles & Practices controls complexity
* Divide & Conquer!
* But complexity will still increase
* Tooling is the glue that stops complexity getting out of control
</script>
</section>

<section data-markdown>
<script type="text/template">
## Benefits of Tooling

* Coding Style: enforcement
* Code Structure: automation and enforcement
* Architecture: reusability and enforcement
* Asset Structure: automation and enforcement
* Code Quality: automation and enforcement
</script>
<aside class="notes">
* No matter how simple individual things are
* No matter how simple conventions are to follow (for consistency)
* As the list of things grows, complexity will be introduced
* Tooling is the glue to keep that complexity at bay
  * It helps productivity by doing things for you
  * It enforces constraints to ensure standards are met
</aside>
</section>

<aside class="notes">
* JSHint
* Creating classes and interfaces and code checking
</aside>
</section>

<section data-markdown>
<script type="text/template">
## Thanks / Questions

Phil [@leggetter](https://twitter.com/leggetter)

[phil@leggetter.co.uk](mailto:phil@leggetter.co.uk)

[Caplin Systems](http://www.caplin.com)

<a href="http://bladerunnerjs.org">
  <img src="../img/bladerunner-js-white-trans-lrg.png" style="border: 0; box-shadow: none; background: none; width: 50%"; />
</a>

[@BladeRunnerJS](https://twitter.com/bladerunnerjs)
</script>
</section>

</section>
<!--/Conclusion-->

    </div>

    <script src="../lib/js/head.min.js"></script>
    <script src="../js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        width: 1280,
        height: 800,

        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

      Reveal.addEventListener( 'ready', function( event ) {
          // event.currentSlide, event.indexh, event.indexv

          setTimeout( replaceWithOnlineImages, 3000 );
      } );

      function replaceWithOnlineImages() {
        var sections = document.querySelectorAll( '[data-online-img]' );
        for( var i = 0, l = sections.length; i < l; ++i ) {
          var section = sections[ i ];
          var replaceImg = section.querySelector( 'img' );
          var img = new Image();
          img.src =  section.getAttribute( 'data-online-img' );
          img.onload = replaceWrapper( replaceImg, img );
        }
      }

      function replaceWrapper( replaceImg, withImg ) {
        return function() {
          replaceImgOnLoad( replaceImg, withImg );
        };
      }

      function replaceImgOnLoad( replaceImg, withImg ) {
        replaceImg.src = withImg.src;
      }

    </script>

  </body>
</html>
